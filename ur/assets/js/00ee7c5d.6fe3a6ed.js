"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[6224],{7851:(e,s,n)=>{n.r(s),n.d(s,{default:()=>_});var o=n(6540),t=n(1656),r=n(54);const a={progressContainer:"progressContainer_PEMa",progressHeader:"progressHeader_QZng",moduleName:"moduleName_Ajjn",percentage:"percentage_qQgU",progressBar:"progressBar_tQsV",progressFill:"progressFill_vIq6",progressDetails:"progressDetails_Pkv1"};var i=n(4848);function c({moduleId:e,progressPercentage:s,viewedSections:n,totalSections:o}){return(0,i.jsxs)("div",{className:a.progressContainer,children:[(0,i.jsxs)("div",{className:a.progressHeader,children:[(0,i.jsx)("span",{className:a.moduleName,children:e}),(0,i.jsxs)("span",{className:a.percentage,children:[s,"%"]})]}),(0,i.jsx)("div",{className:a.progressBar,children:(0,i.jsx)("div",{className:a.progressFill,style:{width:`${s}%`}})}),void 0!==n&&void 0!==o&&(0,i.jsxs)("div",{className:a.progressDetails,children:[n," of ",o," sections viewed"]})]})}var d=n(5709),l=n(8774);const m={bookmarksList:"bookmarksList_dJgK",moduleGroup:"moduleGroup_ogkf",moduleTitle:"moduleTitle_dlFL",bookmarkList:"bookmarkList_SF5l"};function h(){const[e,s]=(0,o.useState)([]),[n,t]=(0,o.useState)(!0);if((0,o.useEffect)(()=>{d.Y.getBookmarks().then(e=>s(e.bookmarks||[])).catch(console.error).finally(()=>t(!1))},[]),n)return(0,i.jsx)("div",{children:"Loading bookmarks..."});if(0===e.length)return(0,i.jsx)("div",{children:"No bookmarks yet."});const r=e.reduce((e,s)=>(e[s.moduleId]||(e[s.moduleId]=[]),e[s.moduleId].push(s),e),{});return(0,i.jsx)("div",{className:m.bookmarksList,children:Object.entries(r).map(([e,s])=>(0,i.jsxs)("div",{className:m.moduleGroup,children:[(0,i.jsx)("h3",{className:m.moduleTitle,children:e}),(0,i.jsx)("ul",{className:m.bookmarkList,children:s.map(e=>(0,i.jsx)("li",{children:(0,i.jsx)(l.A,{to:`/modules/${e.moduleId}/${e.sectionId}`,children:e.sectionId})},e.id))})]},e))})}var u=n(1337);const j={notesList:"notesList_RvXz",noteItem:"noteItem_nSMT",noteHeader:"noteHeader_puuA",noteLink:"noteLink_YrfQ",noteDate:"noteDate_oUS7",notePreview:"notePreview_uis1"};function x(){const[e,s]=(0,o.useState)([]),[n,t]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{u.a.getNotes().then(e=>s(e.notes||[])).catch(console.error).finally(()=>t(!1))},[]),n?(0,i.jsx)("div",{children:"Loading notes..."}):0===e.length?(0,i.jsx)("div",{children:"No notes yet."}):(0,i.jsx)("div",{className:j.notesList,children:e.map(e=>(0,i.jsxs)("div",{className:j.noteItem,children:[(0,i.jsxs)("div",{className:j.noteHeader,children:[(0,i.jsxs)(l.A,{to:`/modules/${e.moduleId}/${e.sectionId}`,className:j.noteLink,children:[e.moduleId," / ",e.sectionId]}),(0,i.jsx)("span",{className:j.noteDate,children:new Date(e.updatedAt).toLocaleDateString()})]}),(0,i.jsxs)("div",{className:j.notePreview,children:[e.content.substring(0,100),e.content.length>100?"...":""]})]},e.id))})}var g=n(6655);const p={recommendations:"recommendations_pd_N",recommendationsList:"recommendationsList_v0Dv",recommendationItem:"recommendationItem_cjdx",recommendationLink:"recommendationLink_eWwp",reason:"reason_t6Jh"};function v(){const[e,s]=(0,o.useState)([]),[n,t]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{const e=(0,g.O)();fetch(`${e}/api/personalization/recommendations`,{credentials:"include"}).then(e=>e.json()).then(e=>s(e.recommendations||[])).catch(console.error).finally(()=>t(!1))},[]),n?(0,i.jsx)("div",{children:"Loading recommendations..."}):0===e.length?(0,i.jsx)("div",{children:"No recommendations available."}):(0,i.jsxs)("div",{className:p.recommendations,children:[(0,i.jsx)("h3",{children:"Recommended Next Steps"}),(0,i.jsx)("ul",{className:p.recommendationsList,children:e.map(e=>(0,i.jsxs)("li",{className:p.recommendationItem,children:[(0,i.jsx)(l.A,{to:`/modules/${e.moduleId}/`,className:p.recommendationLink,children:e.moduleId}),(0,i.jsx)("span",{className:p.reason,children:e.reason})]},e.moduleId))})]})}const N={commentsList:"commentsList_yQc0",commentItem:"commentItem_kCbG",commentHeader:"commentHeader_yKuv",commentLink:"commentLink_d0e4",commentDate:"commentDate_MXss",commentContent:"commentContent_oiAd"};function f(){const[e,s]=(0,o.useState)([]),[n,t]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{const e=(0,g.O)();fetch(`${e}/api/personalization/dashboard`,{credentials:"include"}).then(e=>e.json()).then(e=>s(e.comments||[])).catch(console.error).finally(()=>t(!1))},[]),n?(0,i.jsx)("div",{children:"Loading comments..."}):0===e.length?(0,i.jsx)("div",{children:"No comments yet."}):(0,i.jsx)("div",{className:N.commentsList,children:e.map(e=>(0,i.jsxs)("div",{className:N.commentItem,children:[(0,i.jsxs)("div",{className:N.commentHeader,children:[(0,i.jsxs)(l.A,{to:`/modules/${e.moduleId}/${e.sectionId}`,className:N.commentLink,children:[e.moduleId," / ",e.sectionId]}),(0,i.jsx)("span",{className:N.commentDate,children:new Date(e.createdAt).toLocaleDateString()})]}),(0,i.jsxs)("div",{className:N.commentContent,children:[e.content.substring(0,150),e.content.length>150?"...":""]})]},e.id))})}const k={dashboardGrid:"dashboardGrid_gLVK",section:"section_RLyp"};function L(){const{user:e,loading:s}=(0,r.Z)(),[n,a]=(0,o.useState)(null),[d,m]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{if(console.log("Dashboard useEffect - authLoading:",s,"user:",e),!s&&e){const e="undefined"!=typeof window&&window.__AUTH_URL__||"http://localhost:3000";fetch(`${e}/api/personalization/dashboard`,{credentials:"include"}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>a(e)).catch(e=>{console.error("Dashboard fetch error:",e)}).finally(()=>m(!1))}else s||e||(console.log("No user found, setting loading to false"),m(!1))},[e,s]),s||d?(0,i.jsx)(t.A,{title:"Dashboard",description:"Your personal dashboard",children:(0,i.jsx)("div",{className:"container margin-vert--lg",children:(0,i.jsx)("div",{children:"Loading..."})})}):e?(0,i.jsx)(t.A,{title:"Dashboard",description:"Your personal dashboard",children:(0,i.jsxs)("div",{className:"container margin-vert--lg",children:[(0,i.jsxs)("h1",{children:["Welcome, ",e.name||e.email,"!"]}),(0,i.jsxs)("div",{className:k.dashboardGrid,children:[(0,i.jsxs)("section",{className:k.section,children:[(0,i.jsx)("h2",{children:"Progress"}),n?.progress?.summary?Object.entries(n.progress.summary).map(([e,s])=>(0,i.jsx)(c,{moduleId:e,progressPercentage:s.progressPercentage,viewedSections:s.viewedSections,totalSections:s.totalSections},e)):(0,i.jsx)("p",{children:"No progress tracked yet."})]}),(0,i.jsxs)("section",{className:k.section,children:[(0,i.jsx)("h2",{children:"Bookmarks"}),(0,i.jsx)(h,{})]}),(0,i.jsxs)("section",{className:k.section,children:[(0,i.jsx)("h2",{children:"Notes"}),(0,i.jsx)(x,{})]}),n?.recommendations&&n.recommendations.length>0&&(0,i.jsxs)("section",{className:k.section,children:[(0,i.jsx)("h2",{children:"Recommendations"}),(0,i.jsx)(v,{})]}),n?.comments&&n.comments.length>0&&(0,i.jsxs)("section",{className:k.section,children:[(0,i.jsx)("h2",{children:"Your Comments"}),(0,i.jsx)(f,{})]})]})]})}):(0,i.jsx)(t.A,{title:"Dashboard",description:"Your personal dashboard",children:(0,i.jsxs)("div",{className:"container margin-vert--lg",children:[(0,i.jsx)("h1",{children:"Dashboard"}),(0,i.jsxs)("p",{children:["Please ",(0,i.jsx)(l.A,{to:"/signin",children:"sign in"})," to view your dashboard."]})]})})}function _(){return(0,i.jsx)(r.O,{children:(0,i.jsx)(L,{})})}}}]);
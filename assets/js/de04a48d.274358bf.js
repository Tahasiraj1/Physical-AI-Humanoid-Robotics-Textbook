"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[7837],{2535:(e,s,o)=>{o.r(s),o.d(s,{default:()=>t});var n=o(6540),r=o(1656),i=o(54),l=o(8774);const c={resourceSection:"resourceSection_k6uB",resourceList:"resourceList_Ej9O",resourceItem:"resourceItem_JQtR",resourceInfo:"resourceInfo_D7yk",downloadButton:"downloadButton_NvwC"};var a=o(4848);function t(){const{user:e}=(0,i.Z)(),[s,o]=(0,n.useState)([]),[t,d]=(0,n.useState)(!0);(0,n.useEffect)(()=>{if(e){const e="undefined"!=typeof window&&window.__AUTH_URL__||"http://localhost:3000";fetch(`${e}/api/personalization/resources`,{credentials:"include"}).then(e=>401===e.status?(window.location.href="/signin",null):e.json()).then(e=>{e&&o(e.resources||[])}).catch(console.error).finally(()=>d(!1))}else d(!1)},[e]);if(!e)return(0,a.jsx)(r.A,{title:"Resources",description:"Downloadable resources",children:(0,a.jsxs)("div",{className:"container margin-vert--lg",children:[(0,a.jsx)("h1",{children:"Downloadable Resources"}),(0,a.jsxs)("p",{children:["Please ",(0,a.jsx)(l.A,{to:"/signin",children:"sign in"})," to access downloadable resources."]})]})});if(t)return(0,a.jsx)(r.A,{title:"Resources",description:"Downloadable resources",children:(0,a.jsx)("div",{className:"container margin-vert--lg",children:(0,a.jsx)("div",{children:"Loading resources..."})})});const u=s.reduce((e,s)=>{const o=s.moduleId||"general";return e[o]||(e[o]=[]),e[o].push(s),e},{});return(0,a.jsx)(r.A,{title:"Resources",description:"Downloadable resources",children:(0,a.jsxs)("div",{className:"container margin-vert--lg",children:[(0,a.jsx)("h1",{children:"Downloadable Resources"}),0===s.length?(0,a.jsx)("p",{children:"No resources available at this time."}):Object.entries(u).map(([s,o])=>(0,a.jsxs)("section",{className:c.resourceSection,children:[(0,a.jsx)("h2",{children:"general"===s?"General Resources":s}),(0,a.jsx)("ul",{className:c.resourceList,children:o.map(s=>(0,a.jsxs)("li",{className:c.resourceItem,children:[(0,a.jsxs)("div",{className:c.resourceInfo,children:[(0,a.jsx)("h3",{children:s.fileName}),s.description&&(0,a.jsx)("p",{children:s.description}),(0,a.jsxs)("small",{children:[s.fileType," \u2022 ",s.fileSize?`${(s.fileSize/1024).toFixed(2)} KB`:"Unknown size"]})]}),(0,a.jsx)("button",{onClick:()=>(async s=>{if(e)try{const e="undefined"!=typeof window&&window.__AUTH_URL__||"http://localhost:3000",o=await fetch(`${e}/api/personalization/resources/${s}/download`,{method:"POST",credentials:"include"});if(!o.ok)throw new Error("Download failed");{const e=await o.json();e.downloadUrl&&window.open(e.downloadUrl,"_blank")}}catch(o){console.error("Download error:",o),alert("Failed to download resource. Please try again.")}else window.location.href="/signin"})(s.id),className:c.downloadButton,children:"Download"})]},s.id))})]},s))]})})}}}]);
"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[6224],{1337:(e,s,t)=>{t.d(s,{a:()=>r});var o=t(4586);const n="/api/personalization";const r=new class{getAuthUrl(){try{const{siteConfig:e}=(0,o.A)();return e.customFields?.authUrl||"http://localhost:3000"}catch{return"undefined"!=typeof window&&window.__AUTH_URL__||"http://localhost:3000"}}async createOrUpdateNote(e,s,t){const o=this.getAuthUrl(),r=await fetch(`${o}${n}/notes`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({moduleId:e,sectionId:s,content:t})});if(!r.ok)throw new Error("Failed to save note");return r.json()}async getNotes(e,s){let t=`${this.getAuthUrl()}${n}/notes`;const o=new URLSearchParams;e&&o.append("moduleId",e),s&&o.append("sectionId",s),o.toString()&&(t+=`?${o.toString()}`);const r=await fetch(t,{credentials:"include"});if(!r.ok)throw new Error("Failed to fetch notes");return r.json()}async deleteNote(e){const s=this.getAuthUrl(),t=await fetch(`${s}${n}/notes/${e}`,{method:"DELETE",credentials:"include"});if(!t.ok)throw new Error("Failed to delete note");return t.json()}}},5709:(e,s,t)=>{t.d(s,{Y:()=>n});const o="/api/personalization";const n=new class{getAuthUrl(){return"undefined"!=typeof window&&(window.__AUTH_URL__||document.querySelector('meta[name="auth-url"]')?.getAttribute("content"))||"http://localhost:3000"}async createBookmark(e,s){const t=this.getAuthUrl(),n=await fetch(`${t}${o}/bookmarks`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({moduleId:e,sectionId:s})});if(!n.ok){const e=await n.json().catch(()=>({})),s=new Error(e.message||"Failed to create bookmark");throw s.response=n,s.status=n.status,s}return n.json()}async deleteBookmark(e){const s=this.getAuthUrl(),t=await fetch(`${s}${o}/bookmarks/${e}`,{method:"DELETE",credentials:"include"});if(!t.ok){const e=await t.json().catch(()=>({})),s=new Error(e.message||"Failed to delete bookmark");throw s.response=t,s.status=t.status,s}return t.json()}async getBookmarks(e){const s=this.getAuthUrl(),t=e?`${s}${o}/bookmarks?moduleId=${e}`:`${s}${o}/bookmarks`,n=await fetch(t,{credentials:"include"});if(!n.ok)throw new Error("Failed to fetch bookmarks");return n.json()}async checkBookmark(e,s){const t=this.getAuthUrl(),n=await fetch(`${t}${o}/bookmarks/check?moduleId=${encodeURIComponent(e)}&sectionId=${encodeURIComponent(s)}`,{credentials:"include"});if(!n.ok){if(401===n.status)return{isBookmarked:!1,bookmark:null};const e=await n.json().catch(()=>({})),s=new Error(e.message||"Failed to check bookmark");throw s.response=n,s.status=n.status,s}return n.json()}}},7851:(e,s,t)=>{t.r(s),t.d(s,{default:()=>v});var o=t(6540),n=t(1656),r=t(54);const a={progressContainer:"progressContainer_PEMa",progressHeader:"progressHeader_QZng",moduleName:"moduleName_Ajjn",percentage:"percentage_qQgU",progressBar:"progressBar_tQsV",progressFill:"progressFill_vIq6",progressDetails:"progressDetails_Pkv1"};var i=t(4848);function c({moduleId:e,progressPercentage:s,viewedSections:t,totalSections:o}){return(0,i.jsxs)("div",{className:a.progressContainer,children:[(0,i.jsxs)("div",{className:a.progressHeader,children:[(0,i.jsx)("span",{className:a.moduleName,children:e}),(0,i.jsxs)("span",{className:a.percentage,children:[s,"%"]})]}),(0,i.jsx)("div",{className:a.progressBar,children:(0,i.jsx)("div",{className:a.progressFill,style:{width:`${s}%`}})}),void 0!==t&&void 0!==o&&(0,i.jsxs)("div",{className:a.progressDetails,children:[t," of ",o," sections viewed"]})]})}var d=t(5709),l=t(8774);const m={bookmarksList:"bookmarksList_dJgK",moduleGroup:"moduleGroup_ogkf",moduleTitle:"moduleTitle_dlFL",bookmarkList:"bookmarkList_SF5l"};function h(){const[e,s]=(0,o.useState)([]),[t,n]=(0,o.useState)(!0);if((0,o.useEffect)(()=>{d.Y.getBookmarks().then(e=>s(e.bookmarks||[])).catch(console.error).finally(()=>n(!1))},[]),t)return(0,i.jsx)("div",{children:"Loading bookmarks..."});if(0===e.length)return(0,i.jsx)("div",{children:"No bookmarks yet."});const r=e.reduce((e,s)=>(e[s.moduleId]||(e[s.moduleId]=[]),e[s.moduleId].push(s),e),{});return(0,i.jsx)("div",{className:m.bookmarksList,children:Object.entries(r).map(([e,s])=>(0,i.jsxs)("div",{className:m.moduleGroup,children:[(0,i.jsx)("h3",{className:m.moduleTitle,children:e}),(0,i.jsx)("ul",{className:m.bookmarkList,children:s.map(e=>(0,i.jsx)("li",{children:(0,i.jsx)(l.A,{to:`/modules/${e.moduleId}/${e.sectionId}`,children:e.sectionId})},e.id))})]},e))})}var u=t(1337);const p={notesList:"notesList_RvXz",noteItem:"noteItem_nSMT",noteHeader:"noteHeader_puuA",noteLink:"noteLink_YrfQ",noteDate:"noteDate_oUS7",notePreview:"notePreview_uis1"};function j(){const[e,s]=(0,o.useState)([]),[t,n]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{u.a.getNotes().then(e=>s(e.notes||[])).catch(console.error).finally(()=>n(!1))},[]),t?(0,i.jsx)("div",{children:"Loading notes..."}):0===e.length?(0,i.jsx)("div",{children:"No notes yet."}):(0,i.jsx)("div",{className:p.notesList,children:e.map(e=>(0,i.jsxs)("div",{className:p.noteItem,children:[(0,i.jsxs)("div",{className:p.noteHeader,children:[(0,i.jsxs)(l.A,{to:`/modules/${e.moduleId}/${e.sectionId}`,className:p.noteLink,children:[e.moduleId," / ",e.sectionId]}),(0,i.jsx)("span",{className:p.noteDate,children:new Date(e.updatedAt).toLocaleDateString()})]}),(0,i.jsxs)("div",{className:p.notePreview,children:[e.content.substring(0,100),e.content.length>100?"...":""]})]},e.id))})}const g={recommendations:"recommendations_pd_N",recommendationsList:"recommendationsList_v0Dv",recommendationItem:"recommendationItem_cjdx",recommendationLink:"recommendationLink_eWwp",reason:"reason_t6Jh"};function k(){const[e,s]=(0,o.useState)([]),[t,n]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{const e="undefined"!=typeof window&&window.__AUTH_URL__||"http://localhost:3000";fetch(`${e}/api/personalization/recommendations`,{credentials:"include"}).then(e=>e.json()).then(e=>s(e.recommendations||[])).catch(console.error).finally(()=>n(!1))},[]),t?(0,i.jsx)("div",{children:"Loading recommendations..."}):0===e.length?(0,i.jsx)("div",{children:"No recommendations available."}):(0,i.jsxs)("div",{className:g.recommendations,children:[(0,i.jsx)("h3",{children:"Recommended Next Steps"}),(0,i.jsx)("ul",{className:g.recommendationsList,children:e.map(e=>(0,i.jsxs)("li",{className:g.recommendationItem,children:[(0,i.jsx)(l.A,{to:`/modules/${e.moduleId}/`,className:g.recommendationLink,children:e.moduleId}),(0,i.jsx)("span",{className:g.reason,children:e.reason})]},e.moduleId))})]})}const x={commentsList:"commentsList_yQc0",commentItem:"commentItem_kCbG",commentHeader:"commentHeader_yKuv",commentLink:"commentLink_d0e4",commentDate:"commentDate_MXss",commentContent:"commentContent_oiAd"};function f(){const[e,s]=(0,o.useState)([]),[t,n]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{const e="undefined"!=typeof window&&window.__AUTH_URL__||"http://localhost:3000";fetch(`${e}/api/personalization/dashboard`,{credentials:"include"}).then(e=>e.json()).then(e=>s(e.comments||[])).catch(console.error).finally(()=>n(!1))},[]),t?(0,i.jsx)("div",{children:"Loading comments..."}):0===e.length?(0,i.jsx)("div",{children:"No comments yet."}):(0,i.jsx)("div",{className:x.commentsList,children:e.map(e=>(0,i.jsxs)("div",{className:x.commentItem,children:[(0,i.jsxs)("div",{className:x.commentHeader,children:[(0,i.jsxs)(l.A,{to:`/modules/${e.moduleId}/${e.sectionId}`,className:x.commentLink,children:[e.moduleId," / ",e.sectionId]}),(0,i.jsx)("span",{className:x.commentDate,children:new Date(e.createdAt).toLocaleDateString()})]}),(0,i.jsxs)("div",{className:x.commentContent,children:[e.content.substring(0,150),e.content.length>150?"...":""]})]},e.id))})}const w={dashboardGrid:"dashboardGrid_gLVK",section:"section_RLyp"};function _(){const{user:e,loading:s}=(0,r.Z)(),[t,a]=(0,o.useState)(null),[d,m]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{if(console.log("Dashboard useEffect - authLoading:",s,"user:",e),!s&&e){const e="undefined"!=typeof window&&window.__AUTH_URL__||"http://localhost:3000";fetch(`${e}/api/personalization/dashboard`,{credentials:"include"}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>a(e)).catch(e=>{console.error("Dashboard fetch error:",e)}).finally(()=>m(!1))}else s||e||(console.log("No user found, setting loading to false"),m(!1))},[e,s]),s||d?(0,i.jsx)(n.A,{title:"Dashboard",description:"Your personal dashboard",children:(0,i.jsx)("div",{className:"container margin-vert--lg",children:(0,i.jsx)("div",{children:"Loading..."})})}):e?(0,i.jsx)(n.A,{title:"Dashboard",description:"Your personal dashboard",children:(0,i.jsxs)("div",{className:"container margin-vert--lg",children:[(0,i.jsxs)("h1",{children:["Welcome, ",e.name||e.email,"!"]}),(0,i.jsxs)("div",{className:w.dashboardGrid,children:[(0,i.jsxs)("section",{className:w.section,children:[(0,i.jsx)("h2",{children:"Progress"}),t?.progress?.summary?Object.entries(t.progress.summary).map(([e,s])=>(0,i.jsx)(c,{moduleId:e,progressPercentage:s.progressPercentage,viewedSections:s.viewedSections,totalSections:s.totalSections},e)):(0,i.jsx)("p",{children:"No progress tracked yet."})]}),(0,i.jsxs)("section",{className:w.section,children:[(0,i.jsx)("h2",{children:"Bookmarks"}),(0,i.jsx)(h,{})]}),(0,i.jsxs)("section",{className:w.section,children:[(0,i.jsx)("h2",{children:"Notes"}),(0,i.jsx)(j,{})]}),t?.recommendations&&t.recommendations.length>0&&(0,i.jsxs)("section",{className:w.section,children:[(0,i.jsx)("h2",{children:"Recommendations"}),(0,i.jsx)(k,{})]}),t?.comments&&t.comments.length>0&&(0,i.jsxs)("section",{className:w.section,children:[(0,i.jsx)("h2",{children:"Your Comments"}),(0,i.jsx)(f,{})]})]})]})}):(0,i.jsx)(n.A,{title:"Dashboard",description:"Your personal dashboard",children:(0,i.jsxs)("div",{className:"container margin-vert--lg",children:[(0,i.jsx)("h1",{children:"Dashboard"}),(0,i.jsxs)("p",{children:["Please ",(0,i.jsx)(l.A,{to:"/signin",children:"sign in"})," to view your dashboard."]})]})})}function v(){return(0,i.jsx)(r.O,{children:(0,i.jsx)(_,{})})}}}]);